<!DOCTYPE html>
<head>
    <title>Spiral Viewer</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
    <script type="text/javascript">
        if(document.location.search.length < 2) {
            window.location.replace("https://diamond-dogg.github.io/spiral_generator_prealpha/");
        }
        else {
            // bounce to an "actual" link shortener, which then redirects to our viewer
            let shortenedUrl = "https://wheel.to/" + document.location.search.substring(1);
            fetch(shortenedUrl).then((response) => {
                console.log(response.url.substring(0, 57));
                if(response.ok) {
                    if(response.url.length > 56 && response.url.substring(0, 57) == "https://diamond-dogg.github.io/spiral_generator_prealpha/") {
                        window.location.replace(response.url);
                    }
                    else {
                        console.log("Invalid redirect found! Going back to home...");
                        window.location.replace("https://diamond-dogg.github.io/spiral_generator_prealpha/");
                    }
                }
                else {
                    console.log("Redirect URL returned non-OK status code " + response.ok);
                    window.location.replace("https://diamond-dogg.github.io/spiral_generator_prealpha/");
                }
            }).catch((error) => {
                window.location.replace("https://diamond-dogg.github.io/spiral_generator_prealpha/")
            });
        }
    </script>
</body>
